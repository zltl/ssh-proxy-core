# SSH Proxy Core Configuration File
# This is a sample configuration file demonstrating all available options.

# =============================================================================
# Server Settings
# =============================================================================
[server]
# Address to bind to (default: 0.0.0.0)
bind_addr = 0.0.0.0

# Port to listen on (default: 2222)
port = 2222

# Path to host key file (will be generated if not exists)
host_key = /etc/ssh-proxy/host_key

# =============================================================================
# Logging Settings
# =============================================================================
[logging]
# Log level: debug, info, warn, error (default: info)
level = info

# Directory for audit logs
audit_dir = /var/log/ssh-proxy/audit

# =============================================================================
# Connection Limits
# =============================================================================
[limits]
# Maximum concurrent sessions (default: 1000)
max_sessions = 1000

# Session timeout in seconds (default: 3600)
session_timeout = 3600

# Authentication timeout in seconds (default: 60)
auth_timeout = 60

# =============================================================================
# User Definitions
# Format: [user:username]
# 
# Each user section supports:
#   password_hash - Password hash in crypt(3) format ($6$...)
#   pubkey       - Inline public key (OpenSSH format)
#   pubkey_file  - Path to authorized_keys file
#   enabled      - true/false (default: true)
# =============================================================================

# Example user with password authentication
[user:admin]
# Generate hash with: openssl passwd -6 -salt rounds=5000 'yourpassword'
password_hash = $6$saltsalt$abcdefghijklmnopqrstuvwxyz...
enabled = true

# Example user with public key authentication
[user:deploy]
pubkey = ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAB... deploy@example.com
enabled = true

# Example user with both password and pubkey
[user:developer]
password_hash = $6$saltsalt$xyz123...
pubkey_file = /etc/ssh-proxy/users/developer.pub
enabled = true

# Example user with multiple public keys
[user:operator]
pubkey = ssh-rsa AAAAB3... operator-laptop@example.com
pubkey = ssh-ed25519 AAAAC3... operator-desktop@example.com
enabled = true

# =============================================================================
# User to Upstream Route Mappings
# Format: [route:proxy_user_pattern]
#
# Maps proxy users to upstream servers. When a user connects to the proxy,
# the matching route determines which upstream server to connect to and
# which credentials to use.
#
# proxy_user_pattern supports glob patterns:
#   * - matches any characters
#   ? - matches single character
#
# Each route section supports:
#   upstream / host      - Target upstream host
#   port / upstream_port - Target upstream port (default: 22)
#   user / upstream_user - Username for upstream authentication
#   privkey / private_key - Path to private key for upstream auth
#   enabled              - true/false (default: true)
# =============================================================================

# Route admin users to production servers
[route:admin]
upstream = prod-server.example.com
port = 22
user = root
privkey = /etc/ssh-proxy/keys/admin.key
enabled = true

# Route developers to dev server
[route:dev-*]
upstream = dev-server.example.com
upstream_port = 22
upstream_user = developer
private_key = /etc/ssh-proxy/keys/dev.key

# Route QA team to staging
[route:qa-*]
host = staging.example.com
user = qa-user
privkey = /etc/ssh-proxy/keys/staging.key

# Default route for all other users (catch-all)
[route:*]
upstream = bastion.example.com
port = 22
user = guest
privkey = /etc/ssh-proxy/keys/default.key
